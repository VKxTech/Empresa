<div class="max-w-4xl glass-card p-12">
    <div class="mb-12 border-b border-white/5 pb-8">
        <h2 class="text-3xl font-bold mb-2">Ponto de Venda Inteligente</h2>
        <p class="text-white/40">Geração de proposta técnica e comercial baseada na análise técnica do lead.</p>
    </div>

    <form action="/admin/quotes/new" method="POST" class="space-y-12">
        <input type="hidden" name="leadId" value="<%= selectedLead?.id %>">
        
        <!-- Document Meta -->
        <div class="grid md:grid-cols-2 gap-8">
            <div>
                <label class="block text-xs font-bold text-primary uppercase tracking-widest mb-2">Lead Selecionado</label>
                <div class="bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
                    <%= selectedLead?.name %> (<%= selectedLead?.companyName || 'PF' %>)
                </div>
            </div>
            <div>
                <label class="block text-xs font-bold text-primary uppercase tracking-widest mb-2">Título da Proposta</label>
                <input type="text" name="title" value="Proposta de <%= selectedLead?.requests[0]?.projectType || 'Software' %>" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-primary/50 text-white">
            </div>
        </div>

        <!-- Scaffolding Items -->
        <div id="items-container" class="space-y-6">
            <div class="flex justify-between items-center">
                <h4 class="text-xs font-bold text-white/40 uppercase tracking-widest">Escopo de Investimento</h4>
                <button type="button" onclick="addItem()" class="text-primary text-xs font-bold">+ Adicionar Item Customizado</button>
            </div>
            
            <% if (suggestedItems.length > 0) { %>
                <% suggestedItems.forEach(item => { %>
                    <div class="grid grid-cols-4 gap-4 item-row">
                        <div class="col-span-3">
                            <input type="text" name="itemsDesc" value="<%= item.description %>" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white">
                        </div>
                        <div>
                            <input type="number" name="itemsValue" value="<%= item.value %>" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white">
                        </div>
                    </div>
                <% }) %>
            <% } else { %>
                <div class="grid grid-cols-4 gap-4 item-row">
                    <div class="col-span-3">
                        <input type="text" name="itemsDesc" placeholder="Descrição do serviço" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white">
                    </div>
                    <div>
                        <input type="number" name="itemsValue" placeholder="Valor" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white">
                    </div>
                </div>
            <% } %>
        </div>

        <!-- Delivery Logic -->
        <div class="grid md:grid-cols-2 gap-8 pt-8 border-t border-white/5">
            <div>
                <label class="block text-xs font-bold text-primary uppercase tracking-widest mb-2">Prazo Estimado (Semanas)</label>
                <input type="number" name="estimatedWeeks" value="4" required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white">
            </div>
            <div>
                <label class="block text-xs font-bold text-primary uppercase tracking-widest mb-2">Condições de Pagamento</label>
                <input type="text" name="paymentTerms" value="50% na aprovação e 50% na entrega final." required class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white text-sm">
            </div>
        </div>

        <button type="submit" class="w-full btn-primary py-5 text-lg font-black">GERAR PROPOSTA PROFISSIONAL (PDF)</button>
    </form>
</div>

<script>
    function addItem() {
        const container = document.getElementById('items-container');
        const row = document.querySelector('.item-row').cloneNode(true);
        row.querySelectorAll('input').forEach(input => input.value = '');
        container.appendChild(row);
    }
</script>
